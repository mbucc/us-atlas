<!DOCTYPE html>
<meta charset="utf-8">
<style>

    .county { fill: #ddc; stroke: #777;}

    svg {border: solid; border-width: 2px;}

</style>
<body>

<script src="d3.v3.min.js"></script>
<script src="topojson.v1.min.js"></script>

<script>

var aspect_ratio = 1.6180,
    height = 400,
    width = height * aspect_ratio;

var svg = d3.select("body").append("svg")
    .attr("width", width)
    .attr("height", height);

var projection = d3.geo.albers()
    .scale(1)
    .rotate([75,0])
    .translate([0,0]);

var path = d3.geo.path()
    .projection(projection);

d3.json("topo/ma-counties.json", function(error, ma) {

  // http://stackoverflow.com/questions/14492284/center-a-map-in-d3-given-a-geojson-object
  var b = path.bounds(topojson.feature(ma, ma.objects.counties)),
      s = .95 / Math.max((b[1][0] - b[0][0]) / width, (b[1][1] - b[0][1]) / height),
      t = [(width - s * (b[1][0] + b[0][0])) / 2, (height - s * (b[1][1] + b[0][1])) / 2];

  projection
    .scale(s)
    .translate(t);

  console.log(b);

  svg.selectAll(".county")
      .data(topojson.feature(ma, ma.objects.counties).features)
    .enter().append("path")
      .attr("class", function(d) {return "county " + d.id;})
      .attr("d", path);
});

</script>
